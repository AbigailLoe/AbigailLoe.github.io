---
layout: default
title: "Explore Papers"
categories: papers
---
{% include JB/setup %}

<!-- Add d3 and d3-cloud libraries -->
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/d3-cloud@1.2.5/build/d3.layout.cloud.min.js"></script>

<div class="row">
    <div class="col-md-12">
        <div class="centered-pills">
            <ul class="nav nav-pills note-button">
                <li role="presentation">
                    <a class="off" href="/papers/">
                        <i class="fa fa-binoculars fa-fw"></i> Squares
                    </a>
                </li>
                <li role="presentation">
                    <a class="off" href="/papers/archive/year">
                        <i class="fa fa-calendar fa-fw"></i> Year
                    </a>
                </li>
                <li role="presentation">
                    <a class="off" href="/papers/archive/topic">
                        <i class="fa fa-podcast fa-fw"></i> Topic
                    </a>
                </li>
                <li role="presentation" class="active">
                    <a class="off" href="/papers/archive/explore">
                        <i class="fa fa-filter fa-fw"></i> Explore
                    </a>
                </li>
            </ul>
        </div>
        <div class="bigspacer"></div>
    </div>
</div>

<b>Some papers are not listed below. See <a href="https://scholar.google.com/citations?user=3ffCNrEAAAAJ&hl=en" class="label label-primary">Google Scholar</a> for a more complete list.</b><br>

<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Filter Papers</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-3 filter-col">
                        <div class="form-group filter-group">
                            <label for="yearFilter">Year</label>
                            <select class="form-control" id="yearFilter" multiple>
                                {% assign years = site.categories.papers | map: 'year' | uniq %}
                                {% assign numeric_years = years | where_exp: "year", "year != 'submitted'" | sort | reverse %}
                                {% assign submitted_years = years | where_exp: "year", "year == 'submitted'" %}
                                {% for year in submitted_years %}
                                <option value="{{ year }}">{{ year }}</option>
                                {% endfor %}
                                {% for year in numeric_years %}
                                <option value="{{ year }}">{{ year }}</option>
                                {% endfor %}
                            </select>
                            <button class="clear-filter" data-filter="yearFilter">clear</button>
                        </div>
                    </div>
                    <div class="col-md-3 filter-col">
                        <div class="form-group filter-group">
                            <label for="typeFilter">Type</label>
                            <select class="form-control" id="typeFilter" multiple>
                                <option value="statistical">Statistical</option>
                                <option value="substantive">Substantive</option>
                            </select>
                            <button class="clear-filter" data-filter="typeFilter">clear</button>
                        </div>
                    </div>
                    <div class="col-md-4 filter-col">
                        <div class="form-group filter-group">
                            <label for="journalFilter">Venue</label>
                            <select class="form-control" id="journalFilter" multiple>
                                {% assign journals = site.categories.papers | map: 'journal' | compact | uniq | sort %}
                                {% for journal in journals %}
                                <option value="{{ journal }}">{{ journal }}</option>
                                {% endfor %}
                            </select>
                            <button class="clear-filter" data-filter="journalFilter">clear</button>
                        </div>
                    </div>
                    <div class="col-md-2 filter-col">
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button id="resetFilters" class="btn btn-default btn-block">Reset All</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div id="paperCount" class="alert alert-info">
            Showing all papers ({{ site.categories.papers | size }} entries)
        </div>
        <div id="filterCriteria" class="alert alert-warning" style="display: none;">
        </div>
    </div>
</div>

<!-- Add word cloud section -->
<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Word Cloud</h3>
            </div>
            <div class="panel-body">
                <div id="wordcloud" style="width: 100%; height: 400px;"></div>
            </div>
        </div>
    </div>
</div>

<div id="papersList">
    {% for paper in site.categories.papers %}
    <div class="paper-item" 
         data-year="{{ paper.year }}"
         data-journal="{{ paper.journal | default: '' }}"
         data-type="{% if paper.type %}{{ paper.type }}{% else %}substantive{% endif %}"
         data-authors="{{ paper.authors }}">
        <div class="paper-title">
            <span class="paper-number"></span><a href="{{ paper.url }}" class="off" style="font-family: Arial">{{ paper.title }}</a>
        </div>
        <div class="paper-authors">
            {% assign authorsq = paper.authors | split: ', ' %}
            {% for author_iter in authorsq %}
            {% if forloop.last %}
                {% assign in_file = false %}
                {% assign in_file_web = false %}
                {% for person in site.categories.team %}
                    {% if author_iter contains person.title %}
                        {% assign in_file = true %}
                        {% assign in_file_web = person.web %}
                    {% endif %}
                {% endfor %}
                
                {% if in_file %}
                    <a href="http://{{ in_file_web }}">{{ author_iter }}</a> ({{ paper.year }}).
                {% else %}
                    {{ author_iter }} ({{paper.year}}).
                {% endif %}
            {% else %}
                {% assign in_file = false %}
                {% assign in_file_web = false %}
                {% for person in site.categories.team %}
                    {% if author_iter contains person.title %}
                        {% assign in_file = true %}
                        {% assign in_file_web = person.web %}
                    {% endif %}
                {% endfor %}
            
                {% if in_file %}
                    <a href="http://{{ in_file_web }}">{{ author_iter }}</a>,
                {% else %}
                    {{ author_iter }},
                {% endif %}
            {% endif %}
            {% endfor %}
        </div>
        <div class="paper-links">
            {% if paper.journal %}<span class="paper-journal">â–º <em>{{ paper.journal }}</em></span>{% endif %}
            {%if paper.external_link%}<a href="{{ paper.external_link}}" class="label label-info">[paper link]</a>{% endif %}
            {%if paper.github%}<a href="{{ paper.github }}" class="label label-red">[code]</a>{% endif %}
            {%if paper.doi%}<a href="http://dx.doi.org/{{ paper.doi }}" class="label label-default">[doi]</a>{% endif %}
            {%if paper.pdf%}<a href="{{ paper.pdf }}" class="label label-primary">[pdf]</a>{% endif %}
            {%if paper.poster%}<a href="{{ paper.poster }}" class="label label-green">[poster]</a>{% endif %}
            {%if paper.supplement%}<a href="{{ paper.supplement }}" class="label label-primary">[supplement]</a>{% endif %}
            {%if paper.slides%}<a href="{{ paper.slides }}" class="label label-purple">[slides]</a>{% endif %}
        </div>
    </div>
    {% endfor %}
</div>

<style>
.paper-item {
    margin-bottom: 4px;
    padding: 8px;
    border-radius: 5px;
    transition: all 0.3s ease;
}

.paper-item:hover {
    background-color: #f8f9fa;
}

.paper-title {
    font-size: 1.1em;
    margin-bottom: 2px;
}

.paper-authors {
    margin-bottom: 2px;
}

.paper-links {
    margin-top: 2px;
}

.paper-journal {
    margin-right: 10px;
}

.hidden {
    display: none;
}

#paperCount {
    margin-bottom: 15px;
}

.filter-col {
    padding-right: 5px;
    padding-left: 5px;
}

.filter-col .form-control {
    width: 100%;
    min-width: 120px;
}

.filter-group {
    position: relative;
}

.clear-filter {
    position: absolute;
    right: 0;
    top: 0;
    padding: 2px 8px;
    font-size: 11px;
    line-height: 1.2;
    background: #f8f9fa;
    border: 1px solid #ddd;
    border-radius: 3px;
    cursor: pointer;
    display: none;
    color: #666;
}

.clear-filter:hover {
    background: #e9ecef;
    color: #333;
}

.filter-group.has-selection .clear-filter {
    display: block;
}

#wordcloud {
    text-align: center;
    position: relative;
}

.word {
    cursor: pointer;
    transition: all 0.3s ease;
}

.word:hover {
    fill: #007bff;
}

.wordcloud-loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(255, 255, 255, 0.9);
    padding: 20px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    display: none;
}

.wordcloud-loading.active {
    display: block;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const yearFilter = document.getElementById('yearFilter');
    const journalFilter = document.getElementById('journalFilter');
    const typeFilter = document.getElementById('typeFilter');
    const resetButton = document.getElementById('resetFilters');
    const paperItems = document.querySelectorAll('.paper-item');
    const paperCount = document.getElementById('paperCount');
    const filterCriteria = document.getElementById('filterCriteria');
    const totalPapers = paperItems.length;

    // Add word cloud container
    const wordcloudContainer = d3.select('#wordcloud');
    let currentLayout = null;

    function updateFilterGroups() {
        document.querySelectorAll('.filter-group').forEach(group => {
            const select = group.querySelector('select');
            if (select.selectedOptions.length > 0) {
                group.classList.add('has-selection');
            } else {
                group.classList.remove('has-selection');
            }
        });
    }

    function clearFilter(filterId) {
        const filter = document.getElementById(filterId);
        filter.selectedIndex = -1;
        applyFilters();
    }

    // Add click handlers for clear buttons
    document.querySelectorAll('.clear-filter').forEach(button => {
        button.addEventListener('click', function() {
            const filterId = this.dataset.filter;
            clearFilter(filterId);
        });
    });

    function updateFilterCriteria() {
        const selectedYears = Array.from(yearFilter.selectedOptions).map(option => option.value);
        const selectedJournals = Array.from(journalFilter.selectedOptions).map(option => option.value);
        const selectedTypes = Array.from(typeFilter.selectedOptions).map(option => option.value);

        let criteriaText = [];
        
        if (selectedYears.length > 0) {
            criteriaText.push(`Year: ${selectedYears.join(', ')}`);
        }
        if (selectedJournals.length > 0) {
            criteriaText.push(`Venue: ${selectedJournals.join(', ')}`);
        }
        if (selectedTypes.length > 0) {
            criteriaText.push(`Type: ${selectedTypes.join(', ')}`);
        }

        if (criteriaText.length > 0) {
            filterCriteria.innerHTML = `<strong>Filter Criteria:</strong> ${criteriaText.join(' | ')}`;
            filterCriteria.style.display = 'block';
        } else {
            filterCriteria.style.display = 'none';
        }
    }

    function updatePaperCount() {
        const visiblePapers = document.querySelectorAll('.paper-item:not(.hidden)').length;
        if (visiblePapers === totalPapers) {
            paperCount.textContent = `Showing all papers (${totalPapers} entries)`;
        } else {
            paperCount.textContent = `Showing ${visiblePapers} of ${totalPapers} papers`;
        }
    }

    function updateNumbering() {
        let visibleCount = 0;
        paperItems.forEach(item => {
            if (!item.classList.contains('hidden')) {
                visibleCount++;
                const numberSpan = item.querySelector('.paper-number');
                numberSpan.textContent = `${visibleCount}. `;
            } else {
                const numberSpan = item.querySelector('.paper-number');
                numberSpan.textContent = '';
            }
        });
    }

    function generateWordCloud() {
        // Show loading indicator
        wordcloudContainer.selectAll('*').remove();
        const loadingDiv = wordcloudContainer
            .append('div')
            .attr('class', 'wordcloud-loading active')
            .text('Updating word cloud...');

        // Get visible papers
        const visiblePapers = document.querySelectorAll('.paper-item:not(.hidden)');
        let text = '';
        
        // Create an array of promises for fetching paper content
        const paperPromises = Array.from(visiblePapers).map(paper => {
            // Get title
            const title = paper.querySelector('.paper-title').textContent;
            let paperText = title + ' ';

            // Get paper URL and fetch content
            const paperLink = paper.querySelector('.paper-title a').href;
            return fetch(paperLink)
                .then(response => response.text())
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    
                    // Get abstract if available - improved extraction
                    let paperText = title + ' ';
                    
                    // Try different ways to find the abstract
                    const abstractHeading = Array.from(doc.querySelectorAll('strong, h1, h2, h3, h4, h5, h6'))
                        .find(el => el.textContent.toLowerCase().includes('abstract'));
                    
                    if (abstractHeading) {
                        // Get the next element that contains the abstract text
                        let currentNode = abstractHeading.nextElementSibling;
                        while (currentNode && 
                               !(currentNode.tagName && 
                                 currentNode.tagName.match(/^H[1-6]$/) && 
                                 !currentNode.textContent.toLowerCase().includes('abstract'))) {
                            paperText += currentNode.textContent + ' ';
                            currentNode = currentNode.nextElementSibling;
                        }
                    }
                    
                    // Get keywords if available
                    const keywordsHeading = Array.from(doc.querySelectorAll('strong, h1, h2, h3, h4, h5, h6'))
                        .find(el => el.textContent.toLowerCase().includes('keywords'));
                    
                    if (keywordsHeading && keywordsHeading.nextElementSibling) {
                        paperText += keywordsHeading.nextElementSibling.textContent + ' ';
                    }
                    
                    return paperText;
                })
                .catch(error => {
                    console.error('Error fetching paper content:', error);
                    return paperText; // Return just the title if fetch fails
                });
        });

        // Wait for all paper content to be fetched
        Promise.all(paperPromises)
            .then(paperTexts => {
                // Combine all paper texts
                text = paperTexts.join(' ');

                // Common words to exclude
                const stopWords = new Set([
                    'the', 'and', 'of', 'to', 'a', 'in', 'for', 'is', 'on', 'that', 'by', 'this', 'with', 'as', 'at', 'from', 'an', 'are', 'be', 'it', 'or', 'was', 'were', 'will', 'have', 'has', 'had', 'can', 'could', 'would', 'should', 'may', 'might', 'must', 'shall',
                    'using', 'based', 'based on', 'using', 'via', 'through', 'towards', 'toward', 'into', 'onto', 'upon', 'within', 'without', 'about', 'above', 'below', 'under', 'over', 'between', 'among', 'around', 'before', 'after', 'during', 'since', 'until', 'while', 'when', 'where', 'why', 'how', 'what', 'which', 'who', 'whom', 'whose', 'whether', 'if', 'because', 'although', 'though', 'unless', 'except', 'but', 'nor', 'yet', 'so', 'therefore', 'thus', 'hence', 'consequently', 'furthermore', 'moreover', 'however', 'nevertheless', 'nonetheless', 'otherwise', 'instead', 'rather', 'indeed', 'in fact', 'in particular', 'in general', 'in addition', 'in contrast', 'in comparison', 'in conclusion', 'in summary', 'in brief', 'in short', 'in other words',
                    // Add common academic terms to exclude
                    'paper', 'study', 'research','abstract','methods','models',
                     'analysis', 'method', 'approach', 'result', 'conclusion', 'finding', 'data', 'model', 'system', 'process', 'development', 'application', 'implementation', 'evaluation', 'assessment', 'review', 'survey', 'investigation', 'examination', 'exploration', 'discussion', 'consideration', 'perspective', 'framework', 'theory', 'practice', 'case', 'example', 'instance', 'aspect', 'factor', 'element', 'component', 'feature', 'characteristic', 'property', 'attribute', 'quality', 'nature', 'form', 'type', 'kind', 'category', 'class', 'group', 'set', 'collection', 'series', 'sequence', 'order', 'arrangement', 'structure', 'organization', 'pattern', 'design', 'plan', 'scheme', 'strategy', 'tactic', 'technique', 'procedure', 'protocol', 'guideline', 'principle', 'rule', 'law', 'regulation', 'policy', 'standard', 'criterion', 'measure', 'metric', 'indicator', 'parameter', 'variable', 'constant', 'coefficient', 'ratio', 'proportion', 'percentage', 'fraction', 'portion', 'part', 'section', 'segment', 'division', 'unit', 'module', 'block', 'piece', 'item', 'object', 'entity', 'unit', 'entity', 'object', 'item', 'piece', 'block', 'module', 'unit', 'division', 'segment', 'section', 'part', 'portion', 'fraction', 'percentage', 'proportion', 'ratio', 'coefficient', 'constant', 'variable', 'parameter', 'indicator', 'metric', 'measure', 'criterion', 'standard', 'policy', 'regulation', 'law', 'rule', 'principle', 'guideline', 'protocol', 'procedure', 'technique', 'tactic', 'strategy', 'scheme', 'plan', 'design', 'pattern', 'organization', 'structure', 'arrangement', 'order', 'sequence', 'series', 'collection', 'set', 'group', 'class', 'category', 'kind', 'type', 'form', 'nature', 'quality', 'attribute', 'property', 'characteristic', 'feature', 'component', 'element', 'factor', 'aspect', 'instance', 'example', 'case', 'practice', 'theory', 'framework', 'perspective', 'consideration', 'discussion', 'exploration', 'examination', 'investigation', 'survey', 'review', 'assessment', 'evaluation', 'implementation', 'application', 'development', 'process', 'system', 'model', 'data', 'finding', 'conclusion', 'result', 'approach', 'method', 'analysis', 'research', 'study', 'paper'
                ]);

                // Process text and count word frequencies
                const words = text.toLowerCase()
                    .replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, '')
                    .replace(/\s+/g, ' ')
                    .trim()
                    .split(/\s+/)
                    .filter(word => word.length > 2 && !stopWords.has(word));

                const wordCount = {};
                words.forEach(word => {
                    wordCount[word] = (wordCount[word] || 0) + 1;
                });

                // Convert to array of objects for d3-cloud
                const wordData = Object.entries(wordCount)
                    .sort((a, b) => b[1] - a[1]) // Sort by frequency
                    .slice(0, 100) // Take top 100 words
                    .map(([text, size]) => {
                        // Calculate relative size (percentage of total words)
                        const relativeSize = size / words.length;
                        return {
                            text,
                            size: Math.pow(relativeSize * 200, 1.2) * 5 // Scale relative size
                        };
                    });

                // Normalize word sizes to have consistent maximum size
                const maxSize = 100; // Maximum font size in pixels
                const minSize = 20;  // Minimum font size in pixels
                const maxRelativeSize = Math.max(...wordData.map(d => d.size));
                const minRelativeSize = Math.min(...wordData.map(d => d.size));
                
                wordData.forEach(d => {
                    // Linear interpolation between min and max sizes
                    d.size = minSize + (maxSize - minSize) * 
                        ((d.size - minRelativeSize) / (maxRelativeSize - minRelativeSize));
                });

                // Get container dimensions
                const width = wordcloudContainer.node().offsetWidth;
                const height = 400;

                // Create new layout
                if (currentLayout) {
                    currentLayout.stop();
                }

                currentLayout = d3.layout.cloud()
                    .size([width, height])
                    .words(wordData)
                    .padding(2)  // Reduced padding between words
                    .rotate(() => ~~(Math.random() * 2) * 90)
                    .font('Arial')
                    .fontSize(d => d.size)
                    .spiral('archimedean')  // Use archimedean spiral for tighter packing
                    .on('end', draw);

                currentLayout.start();

                function draw(words) {
                    // Clear previous word cloud
                    wordcloudContainer.selectAll('svg').remove();

                    const svg = wordcloudContainer
                        .append('svg')
                        .attr('width', width)
                        .attr('height', height);

                    // Add words with transition
                    const wordElements = svg.append('g')
                        .attr('transform', `translate(${width/2},${height/2})`)
                        .selectAll('text')
                        .data(words)
                        .enter()
                        .append('text')
                        .style('font-size', d => `${d.size}px`)
                        .style('font-family', 'Arial')
                        .style('fill', () => d3.schemeCategory10[~~(Math.random() * 10)])
                        .attr('text-anchor', 'middle')
                        .attr('transform', d => `translate(${d.x},${d.y}) rotate(${d.rotate})`)
                        .text(d => d.text)
                        .classed('word', true)
                        .style('opacity', 0)
                        .transition()
                        .duration(500)
                        .style('opacity', 1);

                    // Hide loading indicator after transition
                    setTimeout(() => {
                        loadingDiv.classed('active', false);
                    }, 500);
                }
            })
            .catch(error => {
                console.error('Error processing papers:', error);
                loadingDiv.classed('active', false);
            });
    }

    function applyFilters() {
        const selectedYears = Array.from(yearFilter.selectedOptions).map(option => option.value);
        const selectedJournals = Array.from(journalFilter.selectedOptions).map(option => option.value);
        const selectedTypes = Array.from(typeFilter.selectedOptions).map(option => option.value);

        paperItems.forEach(item => {
            const year = item.dataset.year;
            const journal = item.dataset.journal;
            const type = item.dataset.type;

            const yearMatch = selectedYears.length === 0 || selectedYears.includes(year);
            const journalMatch = selectedJournals.length === 0 || selectedJournals.includes(journal);
            const typeMatch = selectedTypes.length === 0 || selectedTypes.includes(type);

            if (yearMatch && journalMatch && typeMatch) {
                item.classList.remove('hidden');
            } else {
                item.classList.add('hidden');
            }
        });

        updatePaperCount();
        updateNumbering();
        updateFilterCriteria();
        updateFilterGroups();
        generateWordCloud(); // Generate word cloud immediately after filtering
    }

    // Add event listeners for filters
    yearFilter.addEventListener('change', applyFilters);
    journalFilter.addEventListener('change', applyFilters);
    typeFilter.addEventListener('change', applyFilters);

    resetButton.addEventListener('click', function() {
        yearFilter.selectedIndex = -1;
        journalFilter.selectedIndex = -1;
        typeFilter.selectedIndex = -1;
        applyFilters();
    });

    // Initial updates
    updateNumbering();
    updateFilterCriteria();
    updateFilterGroups();
    generateWordCloud(); // Generate initial word cloud
});
</script>
